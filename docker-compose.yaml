version: '2'

services:

  git:
    image: 'gogs/gogs'
    volumes:
      - git-data:/data
    links:
      - 'db'
    depends_on:
      - 'db'
    ports:
      - '3000'
    env_file: git.env

  db:
    image: 'postgres'
    env_file: db.env
    volumes:
      - db-data:/var/lib/postgresql/data
    
  proxy:
    image: jwilder/nginx-proxy
    ports:
      - '80:80'
      - '443:443'
    volumes:
      - /var/run/docker.sock:/tmp/docker.sock:ro
      - /home/philip/certs:/etc/nginx/certs
    depends_on:
      - 'git'

volumes:
  git-data:
  db-data:
